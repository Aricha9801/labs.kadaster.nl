---
layout: default
title: About Data Stories
---
<div class="flex">
  <div class="flex-content">
    <h1>Kadaster SPARQL Editor (based on YASGUI)</h1>

    <h2>SPARQL Editor (YASQUE)<h2>

    <h3>Supported key combinations</h3>
    <p>
    The following key combinations are supported within the SPARQL Editor (YASQE).

    We sometimes use the notion of a <b>group</b>, wich is either one word
    (space-delimited sequence of non-space characters), a sequences of
    multiple whitespace characters, or one newline.
    </p>
    <p>
    <table class="table">
      <thead>
        <tr><th><b>Key combination</b></th><th><b>Behavior</b></th></tr>
      </thead>
      <tbody>
        <tr><td><code class=hightlight>Alt + Left</code></td><td>Move the cursor to the beginning of the current line.</td></tr>
        <tr><td><code class=hightlight>Alt + Right</code></td><td>Move the cursor to the end of the current line.</td></tr>
        <tr><td><code class=hightlight>Alt + U</code></td><td>Redo the last change within the current selection.</td></tr>
        <tr><td><code class=hightlight>Ctrl + Backspace</code></td><td>Delete to the beginning of the group before the cursor.</td></tr>
        <tr><td><code class=hightlight>Ctrl + Delete</code></td><td>Delete to the beginning of the group after the cursor.</td></tr>
        <tr><td><code class=hightlight>Ctrl + End</code></td><td>Move the cursor to the end of the query.</td></tr>
        <tr><td><code class=hightlight>Ctrl + Home</code></td><td>Move the cursor to the start of the query.</td></tr>
        <tr><td><code class=hightlight>Ctrl + Left</code></td><td>Move the cursor to the left of the group before the cursor.</td></tr>
        <tr><td><code class=hightlight>Ctrl + Right</code></td><td>Move the cursor to the right of the group the cursor.</td></tr>
        <tr><td><code class=hightlight>Ctrl + [</code></td><td>Decrements the indentation for the current line or the lines involved in the current selection.</td></tr>
        <tr><td><code class=hightlight>Ctrl + ]</code></td><td>Increments the indentation for the current line or the lines involved in the current selection.</td></tr>
        <tr><td><code class=hightlight>Ctrl + /</code></td><td>Toggles on/off the commenting of the current line or the lines involved in the current selection.</td></tr>
        <tr><td><code class=hightlight>Ctrl + A</code></td><td>Select the whole query.</td></tr>
        <tr><td><code class=hightlight>Ctrl + D</code></td><td>Deletes the current line or all lines involved in the current selection.</td></tr>
        <tr><td><code class=hightlight>Ctrl + U</code></td><td>Unfo the last change within the current selection.</td></tr>
        <tr><td><code class=hightlight>Ctrl + Y</code></td><td>Redo the last undone edit action.</td></tr>
        <tr><td><code class=hightlight>Ctrl + Z</code></td><td>Undo the last edit action.</td></tr>
        <tr><td><code class=hightlight>Ctrl + Shift + F</code></td><td>Auto-formats the whole query or the lines involved in the current selection.</td></tr>
        <tr><td><code class=hightlight>Shift + Tab</code></td><td>Auto-indents the current line or the lines involved in the current selection.</td></tr>
        <tr><td><code class=hightlight>Tab</code></td><td>Indents the current line or the lines involved in the current selection.</td></tr>
    </tbody>
    </table>
    </p>
    <h2>SPARQL Result Set Viewer (YASR)</h2>

    <h3>SPARQL 2D</h3>
    <p>
    The following SPARQL variable names are used in the 2D visualization:
    <table class="table">
      <thead>
        <tr><th><b>Variable name</b></th><th><b>Purpose</b></th></tr>
      </thead>
      <tbody>
        <tr><td><code class=hightlight>?shape</code></td><td>An arbitrary variable name that gets bound to literals with datatype <code class=hightlight>geo:wktLiteral</code>, and whose name is the prefix of the other variable names in this table.</td></tr>
        <tr><td><code class=hightlight>?shapeColor</code></td><td>The color of the shape bound to <code class=hightlight>?shape</code>.  Either a CSS3 color name, an RGB color code, or a value between 0.0 and 1.0 in combination with the name of a color palette.  The color palettes to choose from are (1) the ones defined by <a href="https://www.npmjs.com/package/colormap"><code class=hightlight>colormap</code></a> or (2) the ones defined by <a href="http://colorbrewer2.org/#type=sequential&scheme=BuGn&n=3">Color Brewer</a>.</td></tr>
        <tr><td><code class=hightlight>?shapeLabel</code></td><td>The text or HTML content of popups that appear when clicking the shape bound to <code class=hightlight>?shape</code>.</td></tr>
      </tbody>
    </table>
    </p>
    <h3>SPARQL 3D</h3>
    <p>
    In addition to the variables supported by SPARQL 2D, the following
    SPARQL variable names are used in the 3D visualization:

    <table class="table">
      <thead>
        <tr><th><b>Variable name</b></th><th><b>Purpose</b></th></tr>
      </thead>
      <tbody>
        <tr><td><code class=hightlight>?shapeHeight</code></td><td>The height in meters of the 2.5D shape that is based on the 2D shape that is bound to <code class=hightlight>?shape</code>.</td></tr>
        <tr><td><code class=hightlight>?shapeOffset</code></td><td>The height in meters at which the 2.5D shape that is based on the 2D shape that is bound to <code class=hightlight>?shape</code> starts.</td></tr>
      </tbody>
    </table>
    </p>

    <h3>SPARQL Gallery</h3>
    <p>
    The following variable names are used in the gallery visualization:

    <table class="table">
      <thead>
        <tr><th><b>Variable name</b></th><th><b>Purpose</b></th></tr>
      </thead>
      <tbody>
        <tr><td><code class=hightlight>?widget</code></td><td>A plain string or a literal with datatype IRI <code class=hightlight>rdf:HTML</code>, which is used as the content of the widgets that are displayed in gallery rows.</td></tr>
      </tbody>
    </table>
    </p>
    <h3>SPARQL Templating</h3>
    <p>
    It is often useful to create HTML snippets within a SPARQL query: this
    allows for moderately intuitive and human-readable visualizations of
    query results (e.g., in SPARQL Gallery, SPARQL 2D, or SPARQL 3D).

    Perfoming all string insertions in SPARQL works, but results in
    queries that are difficult to read and maintain:
  </p>
    <pre class="codeblock"><code>
    prefix rdf: &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns# &gt;
    prefix rdfs: &lt;http://www.w3.org/2000/01/rdf-schema# &gt;
    prefix rvo: &lt;https://data.labs.pdok.nl/def/ &gt;
    select * {
      [ a rvo:Land;
        rdfs:label ?land;
        rvo:hoofdstad/rdfs:label ?hoofdstad;
        rvo:munteenheid/rdfs:label ?munteenheid;
        rvo:vlag ?vlag].
        bind(strdt(concat(
             '&lt;h1&gt;',str(?land),'&lt;/h1&gt;',
             '&lt;figure&gt;',
               '&lt;img src="',str(?vlag),'" style="width: 300px;"&gt;',
               '&lt;figcaption&gt;In ',str(?land),' hanteert men als munteenheid de ',str(?munteenheid),'. De hoofdstad van ',str(?land),' is ',str(?hoofdstad),'.&lt;/figcaption&gt;',
             '&lt;/figure&gt;'), rdf:HTML, ?widget))
    }
    </code></pre>
    </p>
    <p>
    YASGUI introduces SPARQL Templating, which allows one large string to
    be used, rather than a large number of small strings that are
    arguments to <code class=hightlight>concat</code>.  SPARQL variables <code class=hightlight>?abc</code> can be inserted into
    this one large string by using the <code class=hightlight>{{abc}}</code> templating notation.

    In order for a SPARQL variable to be used in this way, it must occur
    in the outer projection, because YASGUI (and not the server) performs
    template substitution.
    </p>
      <pre class="codeblock"><code>
        prefix rdf: &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns# &gt;
        prefix rdfs: &lt;http://www.w3.org/2000/01/rdf-schema# &gt;
        prefix rvo: &lt;https://data.labs.pdok.nl/def/ &gt;
        select * {
          [ a rvo:Land;
            rdfs:label ?land;
            rvo:hoofdstad/rdfs:label ?hoofdstad;
            rvo:munteenheid/rdfs:label ?munteenheid;
            rvo:vlag ?vlag].
          bind('''
               &lt;h1&gt;{{land}}&lt;/h1&gt;
                 &lt;figure&gt;
                   &lt;img src={{vlag}} style="width: 300px;"&gt;
                   &lt;figcaption&gt;In {{land}} hanteert men als munteenheid de {{munteenheid}}. De hoofdstad van {{land}} is {{hoofdstad}}.&lt;/figcaption&gt;
                &lt;/figure&gt;'''^^rdf:HTML as ?widget)
        }
      </code></pre>
    <h2>Kadaster Data Stories</h2>
    <p>
    Data Stories is a way to publish SPARQL query results in a
    human-readable way.
    </p>
    <h3>Stories and Queries</h3>
    <p>
    Data Stories defines the following two HTML elements:
    <ul>
      <li><code class=hightlight>&lt;div class="story"&gt;</code>: The tag that contains zero or more <code class=hightlight>&lt;query&gt;</code> tags and that implements the Data Story.</li>
      <li><code class=hightlight>&lt;query&gt;</code>: The tag that implements one query within the Data Story.</li>
    </ul>
    </p>
    </h4>Story element</h4>
    <p>
    The following attributes are defined on a <i>data story</i> element:
    <ul>
      <li><code class=hightlight>data-endpoint</code>: The URI of the SPARQL endpoint against which all
        queries in the Data Story are executed.</li>
      <li><code class=hightlight>data-output</code>: The output format that is used to display SPARQL
        result sets in.  The following values are supported:</li>
      <li><code class=hightlight>boolean</code>: Shows the result of an <code class=hightlight>ask</code> query.</li>
      <li><code class=hightlight>error</code>: TODO</li>
      <li><code class=hightlight>gallery</code>: Shows HTML widgets in card rows.</li>
      <li><code class=hightlight>gchart</code>: Shows a UI for selecting numeric properties in order
        to generate various diagrams.</li>
      <li><code class=hightlight>geo</code>: Shows GeoSPARQL results on a 2D map.</li>
      <li><code class=hightlight>geo3d</code>: Shows GeoSPARQL results on a 3D map.</li>
      <li><code class=hightlight>pivot</code>: Shows a UI for selecting numeric properties in order to
        generate various diagrams and pivot tables.</li>
      <li><code class=hightlight>raw</code>: The textual content of the HTTP reply body. For example,
        the SPARQL result set serialized in XML, JSON, or CSV.</li>
      <li><code class=hightlight>table</code>: Shows the results in rows of an HTML table.  This is
        the default value.</li>
    <ul>
    </p>
    <h4>Query element</h4>
    <p>
    The following attributes are defined on the <code class=hightlight>query</code> element:
    <ul>
      <li><code class=hightlight>data-config="URI"</code>: A URI that encodes a query together with the
        configuration of a specific view.  These URIs can be created
        within the SPARQL IDE.</li>
      <li><code class=hightlight>data-endpoint="URI"</code>: The URI of the SPARQL endpoint against
        which a particular query is evaluated.  When absent, the value of
        this attribute on the <code class=hightlight>&lt;div class="story"&gt;</code> tag is used.</li>
      <li><code class=hightlight>data-query-ref="URI"</code>: An absolute or relative URI to a file that
        stores a SPARQL query.</li>
      <li><code class=hightlight>data-output="VALUE"</code>: The output format that is used to display
        the SPARQL result set.  When absent, the value of this attribute
        on the <code class=hightlight>&lt;div class="story"&gt;</code> tag is used.  See the documentation
        of the Story element for the supported values.</li>
      <li><code class=hightlight>data-show-query</code>: Used to show the query directly to the user.</li>
    </ul>
    </p>
  </div>
</div>
